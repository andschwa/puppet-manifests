---
classes:
  - ghost
  - gitlab
  - mumble
  - postgresql
  - postgresql::globals
  - postgresql::server
  - prosody
  - nginx
  - redis

ghost::environment: production
ghost::production_url: https://schwartzmeyer.com

gitlab::git_email: git@suchcodemuchlove.com
gitlab::gitlab_backup: "%{gitlab::git_home}/backups"
gitlab::gitlab_dbtype: pgsql
gitlab::gitlab_dbname: git
gitlab::gitlab_dbuser: git
gitlab::gitlab_dbpwd: "%{hiera('gitlab_dbpwd')}"
gitlab::gitlab_domain: suchcodemuchlove.com
gitlab::gitlab_ssl: true
gitlab::gitlab_ssl_cert: '/etc/nginx/ssl/suchcodemuchlove.com.crt'
gitlab::gitlab_ssl_key: '/etc/nginx/ssl/suchcodemuchlove.com.key'

mumble::snapshot: true

nginx::nginx_vhosts:
  idahothegoodlife.com:
    www_root: '/var/www/idahothegoodlife.com'
    rewrite_www_to_non_www: true
  schwartzmeyer.com:
    proxy: http://127.0.0.1:2368
    proxy_set_header:
      - Host $http_host
      - X-Forwarded-Proto $scheme
      - X-Forwarded-For $proxy_add_x_forwarded_for
      - X-Real-IP $remote_addr
    ssl: true
    ssl_cert: '/etc/nginx/ssl/schwartzmeyer.com.crt'
    ssl_key: '/etc/nginx/ssl/schwartzmeyer.com.key'
    rewrite_www_to_non_www: true
    rewrite_to_https: true

postgresql::globals::manage_package_repo: true
postgresql::globals::version: '9.3'
postgresql::dbs:
  git:
    user: git
    password: "%{hiera('gitlab_dbpwd')}"

person::groups:
  - git

ubuntu::location: http://mirrors.digitalocean.com/ubuntu/

ufw::allows:
  allow-http-from-all:
    port: 80
  allow-https-from-all:
    port: 443
  allow-minecraft-from-all:
    port: 25565
  allow-mumble-from-all:
    port: 64738
  allow-mumble-udp-from-all:
    proto: udp
    port: 64738
